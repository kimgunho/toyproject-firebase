# firebase test practive

ê¸°ë¡ : 666 ê³µí¬ ì»¤ë®¤ë‹ˆí‹°ë¥¼ ì§„í–‰í•˜ë©° í•¨ê»˜ í™œìš©í•œ firebase ê¸°ëŠ¥ì„ ì¢€ë” ì†Œí™”ì‹œí‚¤ê¸° ìœ„í•˜ì—¬ ê¸°ë¡ì„ ë‚¨ê¹ë‹ˆë‹¤.
ë””ìì¸ê³¼ ê²€ì¦ì€ ì¶”í›„ì²˜ë¦¬ë¡œ í•˜ë©° firebaseì˜ ê¸°ëŠ¥ì ì¸ ë¶€ë¶„ë§Œ ê¸°ë¡í•˜ê¸° ìœ„í•œ ëª©ì ì…ë‹ˆë‹¤.

ë˜í•œ ì˜¨ë¼ì¸ê°•ì˜ë¥¼ ì°¾ì•„ê°€ë©° í•´ë³´ì•˜ì§€ë§Œ êµ­ë‚´ ê°•ì˜ëŠ” ëŒ€ë¶€ë¶„ 8ë²„ì ¼ ìœ„ì£¼ì˜€ìŠµë‹ˆë‹¤.
ìµœì‹ ë²„ì ¼ì¸ 9ë²„ì ¼ì˜ ì‚¬ìš©ë²•ì„ ê¸°ë¡í•´ë´…ì‹œë‹¤. ğŸ‘

## login

ë¡œê·¸ì¸ ê¸°ëŠ¥ê´€ë ¨ì„ ê¸°ë¡í•´ë´…ì‹œë‹¤.
authì˜ ê¸°ëŠ¥ì„ ë¶ˆëŸ¬ì˜¤ëŠ” importëŠ” ì•„ë˜ì…ë‹ˆë‹¤.

```
import { getAuth } from 'firebase/auth'; // auth
```

### ì¼ë°˜ íšŒì›ê°€ì… & ìœ ì € í”„ë¡œí•„ ë°ì´í„°

ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì¼ë°˜ê°€ì…ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.
ê²€ì¦ì„ ìœ„í•´ì„œëŠ”

- ë¹„ë°€ë²ˆí˜¸ ë™ì¼ ì²´í¬
- auth/email-already-in-use : ì‚¬ìš©ì¤‘ì¸ ì´ë©”ì¼ê°’
- auth/invalid-email : ì‚¬ìš©ì— ì í•©í•˜ì§€ ì•ŠëŠ” ì´ë©”ì¼ í˜•íƒœ
  ê¸°ëŠ¥ì„ ì ìš©í•˜ì—¬ì•¼í•˜ì§€ë§Œ í˜„ì¬ í…ŒìŠ¤íŠ¸ í”„ë¡œì íŠ¸ëŠ” firebaseì˜ ì „ë°˜ì ì¸ í° íë¦„ì„ ìš°ì„ ì ìœ¼ë¡œ íŒŒì•…í•˜ê³ ì í•¨ì´ë¯€ë¡œ
  ìƒëµí•©ë‹ˆë‹¤.

í”„ë¡œí•„ì—ì„œ íšŒì› í”„ë¡œí•„ì‚¬ì§„ì˜ ê²½ìš° ì´ë¯¸ì§€ì´ê¸° ë•Œë¬¸ì— Storageë¥¼ ì´ìš©í•˜ì—¬ ë”°ë¡œ ìœ ì €ì˜ ì´ë¯¸ì§€ ì½œë ‰ì…˜ì´ ì¡´ì¬í•˜ì—¬ì•¼í•©ë‹ˆë‹¤.
ì´ëŠ” ì•„ë˜ì—ì„œ ì¢€ë” ìƒì„¸í•˜ê²Œ ê¸°ë¡í•  ì˜ˆì •ì…ë‹ˆë‹¤.
ì•„ë˜ ì½”ë“œì˜ ì£¼ì„ì„ í•¨ê»˜ë³´ë©° ì†Œí™”ë¥¼ ì‹œì¼œë´…ì‹œë‹¤.

```
import { createUserWithEmailAndPassword, updateProfile } from 'firebase/auth';
// createUserWithEmailAndPassword íšŒì›ìƒì„±
// updateProfile íšŒì›ì˜ í”„ë¡œí•„ë°ì´í„° [í”„ë¡œí•„ì‚¬ì§„ì£¼ì†Œ, ë‹‰ë„¤ì„]

// onSubmitë§Œ ë°œì·Œ

createUserWithEmailAndPassword(auth, email, password) // email, passwordì€ ì…ë ¥ëœ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
.then((userCredential) => {
    const user = userCredential.user; // ì¼ë°˜ íšŒì›ê°€ì…ì€ ì´ê¹Œì§€ì—ì„œ ì¶©ë¶„í•©ë‹ˆë‹¤.

    updateProfile(user, { // í”„ë¡œí•„ ë°ì´í„°ì˜ ì—…ë°ì´íŠ¸ ì‹œì‘ì…ë‹ˆë‹¤.
    displayName: displayName, // displayName = ì´ë¦„ ë˜ëŠ” ë‹‰ë„¤ì„
    })
    .then(() => {
        console.log('í”„ë¡œí•„ë„¤ì„ ë“±ë¡ ì™„ë£Œ'); // í”„ë¡œí•„ ë“±ë¡ ì™„ë£Œ
    })
    .catch((error) => {
        console.log(error.code); // codeë¥¼ ì¶”ê°€í•˜ë©´ ê°„ê²°í•œ ì—ëŸ¬ì½”ë“œê°€ í™•ì¸ê°€ëŠ¥
    });
})
.catch((error) => {
    console.log(error.code); // authì—ì„œ ì—ëŸ¬ë°œìƒì‹œ
})
.finally(() => {
    console.log('auth finish'); ì—ëŸ¬ê°€ë˜ë“  ê°€ì…ì´ ë˜ë“  ì™„ë£Œ
});
```

### ì‡¼ì…œ(sns) ê°€ì… [dbì‘ì—… ì´í›„ ì§„í–‰ì˜ˆì •]

### login

ê°€ì…ëœ ìœ ì €ì˜ ì •ë³´ ê¸°ë°˜ìœ¼ë¡œ ì´ë©”ì¼, ë¹„ë°€ë²ˆí˜¸ë¡œ ë¡œê·¸ì¸ì„ í•©ë‹ˆë‹¤.
ê²€ì¦ì„ ìœ„í•´ì„œëŠ”

- auth/wrong-password : ì˜ëª»ëœ ë¹„ë°€ë²ˆí˜¸
- auth/user-not-found : ì°¾ì„ìˆ˜ì—†ëŠ” ìœ ì €
- auth/invalid-email : ì˜ëª»ëœ í˜•ì‹
  ìœ¼ë¡œ êµ¬ë¶„í•©ë‹ˆë‹¤.
  ë‹¹ì—°í•œ ë§ì´ê² ì§€ë§Œ ë¡œê·¸ì¸ì„ ì™„ë£Œí•˜ë©´ Routerì˜ useNavigate()ë¥¼ ì´ìš©í•˜ì—¬ Homeìœ¼ë¡œ í˜ì´ì§€ì „í™˜ì„ í•´ì£¼ëŠ”ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.
  ë¡œê·¸ì¸ì— í•„ìš”í•œ ê¸°ëŠ¥ì€ signInWithEmailAndPasswordì´ë©°
  ì•„ë˜ì½”ë“œì—ì„œ ì¢€ë” ìƒì„¸í•˜ê²Œ íŒŒì•…í•´ë´…ì‹œë‹¤.

```
// ë°›ì•„ì˜¨ ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ì˜ ê°’ì„ ë§¤ê°œë³€ìˆ˜ì— ì¶”ê°€í•´ì¤€ í›„ ì§„í–‰í•©ë‹ˆë‹¤.

signInWithEmailAndPassword(auth, email, password)
    .then((userCredential) => { // ë¡œê·¸ì¸ ì™„ë£Œ í›„ ì§„í–‰í•©ë‹ˆë‹¤.
    const user = userCredential.user; // ìœ ì €ì˜ í†µí•©ì •ë³´ì´ë©° user.ì œê³µë ˆí¼ëŸ°ìŠ¤ ë¥¼ ì´ìš©í•˜ì—¬ ìƒì„¸í•œ ì •ë³´ê°€ í™•ì¸ê°€ëŠ¥í•©ë‹ˆë‹¤.
    console.log(user);
    })
    .catch((err) => {
    console.log(err.code);
    })
    .finally(() => {
    console.log('ë¡œê·¸ì¸ ì™„ë£Œ');
    navigate(link.home);
    });
};
```

### profile src [dbì‘ì—… ì´í›„ ì§„í–‰ ì˜ˆì •]

## firebase database

ì´ˆë³´ìê°€ ì²˜ìŒ í—·ê°ˆë¦´ìˆ˜ ìˆëŠ” ë¶€ë¶„ì€ firebaseì—ì„œ ì œê³µí•´ì£¼ëŠ”
firestore Databaseì™€ Realtime Databaseì˜ ì‚¬ìš©ê°€ëŠ¥í•œ ë ˆí¼ëŸ°ìŠ¤ì…ë‹ˆë‹¤.
êµ¬ë¶„ì„ í™•ì‹¤í•˜ê²Œ í•œ í›„ ê° ëª©ì ì— ë§ëŠ” ë ˆí¼ëŸ°ìŠ¤ ê°’ì„ ì˜ ì°¾ì•„ì•¼í•©ë‹ˆë‹¤.

firebase databaseì˜ ê¸°ëŠ¥ì„ ë¶ˆëŸ¬ì˜¤ëŠ” importëŠ” ì•„ë˜ì…ë‹ˆë‹¤.

```
import { getFirestore } from 'firebase/firestore'; // firesotore Database
```

### ë°ì´í„° ë“±ë¡

ì €ê°™ì€ ê²½ìš° ì…ë ¥ëœ ë°ì´í„°ì˜ ê°’ì€ useRefë¥¼ í™œìš©í•˜ì—¬ valueê°’ì„ ë°›ì•„ì™”ìŠµë‹ˆë‹¤.
onchangeë¥¼ í™œìš©í•˜ì—¬ í•œë²ˆì— ê°’ì„ ë°›ì•„ì˜¤ëŠ” ë°©ë²•ë„ ì¡´ì¬í•˜ë©°
ì›í•˜ì‹œëŠ” ë°©ì‹ìœ¼ë¡œ ì§„í–‰í•˜ì…”ë„ ë¬´ë°©í•©ë‹ˆë‹¤.
ì˜¨ë¼ì¸ê°•ì˜ì—ì„œëŠ” collection.addë¥¼ ì´ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ë“±ë¡í–ˆì§€ë§Œ
9ë²„ì ¼ì—ì„œëŠ” collection, addDoc ë¥¼ ì´ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ë“±ë¡í–ˆìŠµë‹ˆë‹¤.
ì•„ë˜ ì½”ë“œë¥¼ í™•ì¸í•´ë´…ì‹œë‹¤.

```
import { collection, addDoc } from 'firebase/firestore'; // ë§Œì•½ docì˜ idê°’ì„ ìë™ìœ¼ë¡œ í•´ë„ ëœë‹¤ë©´ <-
import { doc, setDoc } from 'firebase/firestore'; // idê°’ì„ ë‚´ê°€ ìƒì„±í•˜ê¸¸ ë°”ë€ë‹¤ë©´ <-

// use addDoc
try {
    await addDoc(collection(database, 'list'), { // ë„£ê³ ì‹¶ì€ ë°ì´í„°ì˜ ê°’ì„ jsonì˜ í˜•íƒœë¡œ ë„£ì–´ì¤ë‹ˆë‹¤.
    title: title.current.value,
    description: description.current.value,
    text: text.current.value,
    date: Date.now(),
    like: 0,
    user: auth.currentUser.uid,
    name: auth.currentUser.displayName,
    }).then(() => { // ì´ë¶€ë¶„ì€ ì—†ì–´ë„ ë©ë‹ˆë‹¤. í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ í™•ì¸ì°¨ ì¶”ê°€í•˜ì˜€ìŠµë‹ˆë‹¤.
    console.log('ë“±ë¡ì™„ë£Œ');
    });
} catch (error) {
    console.log(error.code);
}

// use setDoc
const id = auth.currentUser.uid.substring(0, 8) + new Date().getTime(); // idê°’ ìƒì„± êµ³ì´ ì´ë ‡ê²Œ ì•ˆë§Œë“¤ì–´ì£¼ì–´ë„ uuidë¥¼ ì‚¬ìš©í•´ë„ í¸í•˜ê²Œ ê°€ëŠ¥
await setDoc(doc(database, 'list', id), {
    ...data
}

```

### ë°ì´í„° ì½ê¸°

ì´ˆê¸°ì—ëŠ” ë¦¬ìŠ¤íŠ¸ì˜ ë°ì´í„°ë“¤ì¤‘ find()í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ ì›í•˜ëŠ” ê²°ê³¼ê°’ì´ í¬í•¨ëœ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ë„ë¡ í•˜ì˜€ìœ¼ë‚˜
firebaseì—ì„œ ì œê³µí•´ì£¼ëŠ” get data onceì˜ ë ˆí¼ëŸ°ìŠ¤ë¥¼ í™•ì¸í•´ë³´ì•˜ìŠµë‹ˆë‹¤.

í•´ë‹¹ ë ˆí¼ëŸ°ìŠ¤ì—ëŠ” ë°ì´í„°ë¥¼ ì½ëŠ” ë°©ë²•ì¤‘ ê²Œì‹œíŒì˜ ë¦¬ìŠ¤íŠ¸ì— ì í•©í•œ í˜•íƒœì™€ ë””í…Œì¼í˜ì´ì§€ì— ì í•©í•œ í˜•íƒœê°€ í™•ì¸ë˜ì—ˆìŠµë‹ˆë‹¤.
ìˆœì°¨ëŒ€ë¡œ ê¸°ë¡í•´ë³´ê² ìŠµë‹ˆë‹¤.

1. ë¦¬ìŠ¤íŠ¸ í˜•ì‹ìœ¼ë¡œ êµ¬ì¡° ì½ê¸°
   import { collection, getDocs } from 'firebase/firestore';
   ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ì½ì–´ì˜µë‹ˆë‹¤.

ì¢€ë” ë””í…Œì¼í•œ ì½”ë“œë¥¼ ë³´ë©° í™•ì¸í•´ë´…ì‹œë‹¤.

```
  const [list, setList] = useState([]); // ë°°ì—´ ìƒì„±
  useEffect(() => {
    getCollection();
  }, []);

  const getCollection = async () => {
    // ì´ë¶€ë¶„ ë¶€í„° í—·ê°ˆë¦´ìˆ˜ ìˆìœ¼ë‚˜ ìì„¸íˆ ë´…ì‹œë‹¤.
    const querySnapshot = await getDocs(collection(database, 'list'));  // ì½œë ‰ì…˜ ë°ì´í„°ì˜ ë¦¬ìŠ¤íŠ¸í´ë”
    querySnapshot.forEach((data) => {
      return setList((prev) => [...prev, data.data()]); // ë°ì´í„°ë¥¼ ìˆœí™˜í•˜ë©° ê° ë°ì´í„°ì˜ ê°’ì„ ë°°ì—´ì— ë„£ì–´ì£¼ì—ˆìŠµë‹ˆë‹¤.
    });
  };
```

ìœ„ ë°©ì‹ì€ ì½œë ‰ì…˜ì˜ íŠ¹ì • í´ë”ì•ˆì— ë°ì´í„°ë¥¼ ì „ì²´ì ìœ¼ë¡œ ìˆœí™˜ì„ ëŒë©° ë°°ì—´ì•ˆì— í‘¸ì‹œí•œ ë°©ì‹ì…ë‹ˆë‹¤.

í•˜ì§€ë§Œ ì—¬ëŸ¬ ë°ì´í„°ê°€ ì•„ë‹Œ íŠ¹ì •ëª©ì ì— ë§ëŠ” í•˜ë‚˜ì˜ ë°ì´í„° ê°ì²´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë°©ì‹ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤. 2. ë””í…Œì¼ í˜•ì‹ìœ¼ë¡œ ë°ì´í„° ì½ê¸°

ë””í…Œì¼í˜•ì‹ì€ ë¼ìš°í„°ì˜ ì„œë¸Œ:idë¥¼ í™œìš©í•˜ì—¬ ì§„í–‰í•˜ì˜€ìŠµë‹ˆë‹¤.
useParams í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ë””í…Œì¼ë‚´ í˜ì´ì§€ detail/:id ê°’ì„ í†µí•˜ì—¬
í•´ë‹¹ sub idê°’ê³¼ ë°ì´í„°ì˜ idì™€ ë¹„êµí•˜ì—¬ ê°™ì€ ê°’ì„ ì°¾ì•„ì£¼ëŠ”
ë°©ì‹ìœ¼ë¡œ ì§„í–‰í–ˆìŠµë‹ˆë‹¤.

ì½”ë“œë¥¼ í™•ì¸í•´ë³´ê² ìŠµë‹ˆë‹¤.

```
  const getDetail = async () => {
    const docRef = doc(database, 'list', item.id); // ë¦¬ìŠ¤íŠ¸í´ë”ì—ì„œ item.idê°’ì´ useParamsë¥¼ í†µí•˜ì—¬ ì•Œì•„ë‚¸ ê°’
    const docSnap = await getDoc(docRef); // docSnapì€ docRefì´ë©° í•´ë‹¹ ë°ì´í„°ë¥¼ ì•„ë˜ì—ì„œ ì…‹í•´ì£¼ì—ˆìŠµë‹ˆë‹¤.
    setDetail(docSnap.data());
  };

  // ì´ì œ detailë°ì´í„°ëŠ” íŠ¹ì • ê°ì²´ì˜ ê°’ì´ë¯€ë¡œ í•´ë‹¹ ë°ì´í„°ë¥¼ ëœë”ë§ í•©ë‹ˆë‹¤.
```

ìŠ¤í„°ë”” ì°¸ê³  ì˜ìƒ : [PedroTech-CRUD Tutorial Using React + Firebase | Firebase 9 and Firestore Tutorial](https://youtu.be/jCY6DH8F4oc)
